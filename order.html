<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Checkout | Warung Ngemil</title>
<meta name="description" content="Checkout pesanan kamu di Warung Ngemil dan selesaikan pembayaran lewat WhatsApp.">

<style>
  body {
    font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Arial,sans-serif;
    margin:0;
    background:#fffaf0;
    color:#1a1a1a;
  }

  /* NAVBAR SAMA SEPERTI INDEX & PRODUK */
  header.site-header {
    background: linear-gradient(90deg,#ff8a00 0%, #ffb84d 100%);
    padding:12px 16px;
    position:sticky;
    top:0;
    box-shadow:0 4px 16px rgba(0,0,0,0.15);
    z-index:1000;
  }

  nav.navbar-inner {
    max-width:1200px;
    margin:0 auto;
    display:flex;
    flex-wrap:wrap;
    align-items:center;
    justify-content:space-between;
    row-gap:12px;
  }

  .brand-box {
    display:flex;
    align-items:center;
    gap:10px;
    font-size:1.1rem;
    font-weight:700;
    color:#1a1a1a;
    letter-spacing:-0.03em;
  }

  .brand-tag {
    font-size:0.7rem;
    font-weight:500;
    color:#4a2b00;
    background:#fff;
    border-radius:6px;
    padding:4px 8px;
    line-height:1.2;
    border:1px solid rgba(0,0,0,0.08);
  }

  .menu-box {
    display:flex;
    flex-wrap:wrap;
    align-items:center;
    justify-content:flex-end;
    column-gap:20px;
    row-gap:10px;
    font-size:0.95rem;
    font-weight:500;
    color:#1a1a1a;
  }

  .menu-box a {
    text-decoration:none;
    color:#1a1a1a;
  }

  .cart-status {
    display:flex;
    align-items:center;
    gap:8px;
    text-decoration:none;
    color:#1a1a1a;
    font-weight:600;
    font-size:0.9rem;
  }

  .cart-icon-bubble {
    background:#1a1a1a;
    color:#fff;
    width:32px;
    height:32px;
    display:flex;
    justify-content:center;
    align-items:center;
    border-radius:8px;
    box-shadow:0 4px 8px rgba(0,0,0,.3);
    font-size:0.8rem;
    line-height:1;
  }

  /* CONTAINER CHECKOUT */
  .container {
    max-width:700px;
    margin:40px auto;
    background:#fff9ef;
    border:1px solid #ffd27a;
    border-radius:12px;
    padding:20px;
    box-shadow:0 8px 20px rgba(0,0,0,0.06);
  }

  h1 {
    text-align:center;
    font-size:1.4rem;
    font-weight:700;
    margin-top:0;
    color:#1a1a1a;
    letter-spacing:-0.03em;
  }

  h2 {
    font-size:1rem;
    font-weight:700;
    color:#1a1a1a;
    margin-bottom:10px;
    letter-spacing:-0.03em;
  }

  .order-list {
    margin-top:20px;
  }

  .item {
    border:1px solid #ffe2a8;
    border-radius:10px;
    background:#fff;
    padding:10px;
    margin-bottom:10px;
    font-size:0.9rem;
    line-height:1.4;
    color:#1a1a1a;
    display:flex;
    justify-content:space-between;
  }

  .total {
    display:flex;
    justify-content:space-between;
    border-top:1px solid #ffd27a;
    margin-top:10px;
    padding-top:10px;
    font-weight:700;
    color:#ff8a00;
    font-size:1rem;
  }

  input, textarea {
    width:100%;
    padding:10px;
    margin-top:8px;
    border-radius:8px;
    border:1px solid #ccc;
    font-size:0.9rem;
    outline:none;
  }

  button {
    width:100%;
    background:#1a1a1a;
    color:#fff;
    padding:12px;
    font-weight:600;
    border:none;
    border-radius:10px;
    margin-top:20px;
    cursor:pointer;
    font-size:0.95rem;
    box-shadow:0 12px 24px rgba(0,0,0,0.4);
  }

  footer {
    background:#1a1a1a;
    color:#ccc;
    text-align:center;
    padding:16px;
    font-size:0.8rem;
    margin-top:40px;
  }
</style>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KPRGS5HW2E"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-KPRGS5HW2E');
</script>
</head>
<body>

<!-- NAVBAR -->
<header class="site-header">
  <nav class="navbar-inner">
    <!-- kiri -->
    <div class="brand-box">
      <div>Warung Ngemil</div>
      <div class="brand-tag">Snack Time!</div>
    </div>

    <!-- kanan -->
    <div class="menu-box">
      <a href="index.html">Home</a>
      <a href="produk.html">Produk</a>
      <a href="order.html">Order</a>
      <a href="kontak.html">Kontak</a>

      <!-- status keranjang (readonly di halaman ini) -->
      <a class="cart-status" style="pointer-events:none; opacity:0.8;">
        <span class="cart-icon-bubble">ðŸ›’</span>
        <span>
          <!-- nilai ini nanti kita isi dari total item pesanan -->
          <span id="cart-count-header">0</span> item |
          Rp <span id="cart-total-header">0</span>
        </span>
      </a>
    </div>
  </nav>
</header>

<!-- CONTENT -->
<div class="container">
  <h1>Checkout Pesanan</h1>

  <!-- DAFTAR PESANAN -->
  <div id="order-list" class="order-list"></div>

  <!-- TOTAL -->
  <div class="total">
    <span>Total Bayar:</span>
    <span>Rp <span id="total-harga">0</span></span>
  </div>

  <!-- FORM PEMBELI -->
  <h2 style="margin-top:30px;">Data Pembeli</h2>
  <form id="checkout-form">
    <label>Nama Lengkap</label>
    <input type="text" id="nama" required placeholder="contoh: Muhamad Dedi">

    <label>Alamat Lengkap</label>
    <textarea id="alamat" rows="3" required placeholder="contoh: Jl. Raya Ngemil No.10, Tangerang"></textarea>

    <label>Nomor WhatsApp</label>
    <input type="tel" id="nomor" required placeholder="contoh: 0818xxxxxxx">

    <button type="submit">Kirim ke WhatsApp âžœ</button>
  </form>
</div>

<footer>
  Â© 2025 Warung Ngemil â€” dibuat oleh Muhamad Dedi
</footer>

<script>
  // --- Ambil data pesanan dari URL ---
  const urlParams = new URLSearchParams(window.location.search);
  const pesanan = urlParams.get('pesanan');
  const total = urlParams.get('total');

  const orderList = document.getElementById('order-list');
  const totalHarga = document.getElementById('total-harga');

  // header mini cart di navbar checkout
  const cartCountHeader = document.getElementById('cart-count-header');
  const cartTotalHeader = document.getElementById('cart-total-header');

  if (pesanan) {
    // pisahkan item berdasarkan koma
    const items = pesanan.split(',');

    // render setiap item ke daftar pesanan
    items.forEach(i => {
      const div = document.createElement('div');
      div.className = 'item';
      div.innerHTML = `
        <span>${i.trim()}</span>
        <span></span>
      `;
      orderList.appendChild(div);
    });

    // total harga
    const totalInt = parseInt(total || "0");
    totalHarga.textContent = totalInt.toLocaleString();

    // update header cart info (jumlah item & total)
    cartCountHeader.textContent = items.length;
    cartTotalHeader.textContent = totalInt.toLocaleString();
  } else {
    orderList.innerHTML = '<p style="color:#666;font-size:0.9rem;">Keranjang kosong. Silakan pilih produk di halaman <a href="produk.html" style="color:#ff8a00;font-weight:600;text-decoration:none;">produk</a>.</p>';
    cartCountHeader.textContent = "0";
    cartTotalHeader.textContent = "0";
  }

  // --- Kirim ke WhatsApp ---
  const form = document.getElementById('checkout-form');
  form.addEventListener('submit', e => {
    e.preventDefault();
    const nama = document.getElementById('nama').value;
    const alamat = document.getElementById('alamat').value;
    const nomor = document.getElementById('nomor').value;

    // fallback kalau total/pesanan kosong
    const totalShow = total ? parseInt(total).toLocaleString() : "0";
    const pesananShow = pesanan ? pesanan : "(kosong)";

    const pesan =
      `Halo Warung Ngemil ðŸ‘‹%0A%0A` +
      `Saya ingin pesan:%0A${encodeURIComponent(pesananShow)}%0A%0A` +
      `Total: Rp ${encodeURIComponent(totalShow)}%0A%0A` +
      `Nama: ${encodeURIComponent(nama)}%0A` +
      `Alamat: ${encodeURIComponent(alamat)}%0A` +
      `No. WA: ${encodeURIComponent(nomor)}`;

    // ganti nomor ini dengan nomor admin kamu (format 62...)
    const url = `https://wa.me/62895405090125?text=${pesan}`;

    // buka WhatsApp di tab baru
    window.open(url, '_blank');

    // redirect ke halaman sukses dalam 2 detik
    setTimeout(() => {
      window.location.href = 'sukses.html';
    }, 2000);
  });
</script>
<button type="submit" onclick="gtag('event', 'begin_checkout');">
  Kirim ke WhatsApp âžœ
</button>

</body>
</html>
